<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/icon32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/icon16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="DBMS - （执行）-&gt; SQL -(操作) -&gt; DB 增删改查 CRUD: create retrieve update delete 表： 行-数据&#x2F;记录 data 列：字段 每个字段包括：字段名、数据类型、约束    	 1234567&gt; mysql -uroot -p123  &#x2F;&#x2F; 登录mysqlmysql&gt; show databases;  &#x2F;&#x2F; 查">
<meta property="og:type" content="article">
<meta property="og:title" content="基础教程">
<meta property="og:url" content="http://example.com/2023/11/17/MySQL/tutorial/index.html">
<meta property="og:site_name" content="Wallnut">
<meta property="og:description" content="DBMS - （执行）-&gt; SQL -(操作) -&gt; DB 增删改查 CRUD: create retrieve update delete 表： 行-数据&#x2F;记录 data 列：字段 每个字段包括：字段名、数据类型、约束    	 1234567&gt; mysql -uroot -p123  &#x2F;&#x2F; 登录mysqlmysql&gt; show databases;  &#x2F;&#x2F; 查">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/drinkwateronly/Image-Host/main/iimage/image-20230914000048586.png">
<meta property="og:image" content="https://raw.githubusercontent.com/drinkwateronly/Image-Host/main/iimage/image-20230830192308964.png">
<meta property="article:published_time" content="2023-11-17T11:21:00.000Z">
<meta property="article:modified_time" content="2023-11-17T11:35:57.708Z">
<meta property="article:author" content="Wallnut">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/drinkwateronly/Image-Host/main/iimage/image-20230914000048586.png">


<link rel="canonical" href="http://example.com/2023/11/17/MySQL/tutorial/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2023/11/17/MySQL/tutorial/","path":"2023/11/17/MySQL/tutorial/","title":"基础教程"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>基础教程 | Wallnut</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Wallnut</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A1%A8%EF%BC%9A"><span class="nav-number">1.</span> <span class="nav-text">表：</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#sql-%E8%AF%AD%E5%8F%A5"><span class="nav-number">2.</span> <span class="nav-text">sql 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQL%E8%AF%AD%E5%8F%A5%E5%88%86%E7%B1%BB"><span class="nav-number">2.1.</span> <span class="nav-text">SQL语句分类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5"><span class="nav-number">2.2.</span> <span class="nav-text">查询语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2Like"><span class="nav-number">2.2.1.</span> <span class="nav-text">模糊查询Like</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%8E%92%E5%BA%8F-order-by"><span class="nav-number">2.2.2.</span> <span class="nav-text">数据排序 order by</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0"><span class="nav-number">2.2.3.</span> <span class="nav-text">分组函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#group-by-%E5%92%8C-having"><span class="nav-number">2.2.3.1.</span> <span class="nav-text">group by 和 having</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#group-by"><span class="nav-number">2.2.3.1.1.</span> <span class="nav-text">group by</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#having"><span class="nav-number">2.2.3.1.2.</span> <span class="nav-text">having</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0%E4%B8%8D%E8%83%BD%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8%E5%9C%A8where%E8%AF%AD%E5%8F%A5%E3%80%82"><span class="nav-number">2.2.3.1.3.</span> <span class="nav-text">分组函数不能直接使用在where语句。</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%BB%E9%87%8Ddistinct"><span class="nav-number">2.2.4.</span> <span class="nav-text">去重distinct</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cast"><span class="nav-number">2.3.</span> <span class="nav-text">cast</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="nav-number">2.4.</span> <span class="nav-text">连接查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2%E5%88%86%E7%B1%BB"><span class="nav-number">2.4.1.</span> <span class="nav-text">连接查询分类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5%E2%80%94%E2%80%94%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5%EF%BC%9A%E6%9D%A1%E4%BB%B6%E6%98%AF%E7%AD%89%E9%87%8F%E5%85%B3%E7%B3%BB"><span class="nav-number">2.4.2.</span> <span class="nav-text">内连接——等值连接：条件是等量关系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5%E2%80%94%E2%80%94%E9%9D%9E%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5"><span class="nav-number">2.4.3.</span> <span class="nav-text">内连接——非等值连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E8%BF%9E%E6%8E%A5%EF%BC%9A%E4%B8%80%E5%BC%A0%E8%A1%A8%E7%9C%8B%E6%88%90%E4%B8%A4%E5%BC%A0%E8%A1%A8%EF%BC%8C%E8%87%AA%E5%B7%B1%E8%BF%9E%E6%8E%A5%E8%87%AA%E5%B7%B1%E3%80%82"><span class="nav-number">2.4.4.</span> <span class="nav-text">自连接：一张表看成两张表，自己连接自己。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">2.4.5.</span> <span class="nav-text">外连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E5%BC%A0%E8%A1%A8%E8%BF%9E%E6%8E%A5"><span class="nav-number">2.4.6.</span> <span class="nav-text">三张表连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A8%E8%BF%9E%E6%8E%A5"><span class="nav-number">2.4.7.</span> <span class="nav-text">全连接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">2.5.</span> <span class="nav-text">子查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#union"><span class="nav-number">2.6.</span> <span class="nav-text">union</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#limit%EF%BC%88%E7%89%B9%E6%9C%89%EF%BC%89"><span class="nav-number">2.7.</span> <span class="nav-text">limit（特有）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86"><span class="nav-number">2.8.</span> <span class="nav-text">文本处理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BB%BA%E8%A1%A8"><span class="nav-number">3.</span> <span class="nav-text">建表</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8F%92%E5%85%A5Insert"><span class="nav-number">4.</span> <span class="nav-text">插入Insert</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A1%A8%E7%9A%84%E5%A4%8D%E5%88%B6"><span class="nav-number">5.</span> <span class="nav-text">表的复制</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E6%8F%92%E5%85%A5%E5%88%B0%E5%8F%A6%E4%B8%80%E4%B8%AA%E8%A1%A8%E4%B8%AD"><span class="nav-number">6.</span> <span class="nav-text">查询结果插入到另一个表中</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AEupdate"><span class="nav-number">7.</span> <span class="nav-text">修改数据update</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="nav-number">8.</span> <span class="nav-text">删除数据</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%A0%E8%A1%A8"><span class="nav-number">9.</span> <span class="nav-text">删表</span></a></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">10.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A1%A8%E7%BB%93%E6%9E%84"><span class="nav-number">11.</span> <span class="nav-text">表结构</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BA%A6%E6%9D%9Fconstraint"><span class="nav-number">12.</span> <span class="nav-text">约束constraint</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F-not-nll"><span class="nav-number">12.1.</span> <span class="nav-text">非空约束 not nll</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%94%AF%E4%B8%80%E6%80%A7%E7%BA%A6%E6%9D%9F-unique"><span class="nav-number">12.2.</span> <span class="nav-text">唯一性约束 unique</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BB%E9%94%AE%E7%BA%A6%E6%9D%9F-primary-key"><span class="nav-number">12.3.</span> <span class="nav-text">主键约束 primary key</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E6%9C%AF%E8%AF%AD%EF%BC%9A"><span class="nav-number">12.3.1.</span> <span class="nav-text">相关术语：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E9%94%AE%E5%88%86%E7%B1%BB%EF%BC%9A"><span class="nav-number">12.3.2.</span> <span class="nav-text">主键分类：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E9%94%AE%E8%87%AA%E5%A2%9E"><span class="nav-number">12.3.3.</span> <span class="nav-text">主键自增</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="nav-number">12.4.</span> <span class="nav-text">外键约束</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E6%9C%AF%E8%AF%AD"><span class="nav-number">12.4.1.</span> <span class="nav-text">相关术语</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%9A%E5%8A%A1%E8%83%8C%E6%99%AF%EF%BC%9A"><span class="nav-number">12.4.2.</span> <span class="nav-text">业务背景：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%EF%BC%88%E4%BA%86%E8%A7%A3%E5%8D%B3%E5%8F%AF%EF%BC%89"><span class="nav-number">13.</span> <span class="nav-text">存储引擎（了解即可）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%EF%BC%88Transaction%EF%BC%89"><span class="nav-number">14.</span> <span class="nav-text">事务（Transaction）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E5%9B%9B%E5%A4%A7%E7%89%B9%E6%80%A7ACID"><span class="nav-number">14.1.</span> <span class="nav-text">事务四大特性ACID</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E4%BA%8B%E5%8A%A1"><span class="nav-number">14.2.</span> <span class="nav-text">演示事务</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%EF%BC%88%E5%BA%95%E5%B1%82%E6%98%AF%E7%BA%A2%E9%BB%91%E6%A0%91%EF%BC%89"><span class="nav-number">15.</span> <span class="nav-text">索引（底层是红黑树）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95%E5%92%8C%E5%88%A0%E9%99%A4%E7%B4%A2%E5%BC%95"><span class="nav-number">16.</span> <span class="nav-text">创建索引和删除索引</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95%E4%BE%8B%E9%A2%98"><span class="nav-number">16.0.1.</span> <span class="nav-text">创建索引例题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E7%B4%A2%E5%BC%95%E4%BE%8B%E9%A2%98"><span class="nav-number">16.0.2.</span> <span class="nav-text">删除索引例题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95"><span class="nav-number">16.1.</span> <span class="nav-text">创建索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E5%8E%9F%E7%90%86"><span class="nav-number">16.2.</span> <span class="nav-text">索引原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="nav-number">16.3.</span> <span class="nav-text">索引分类（了解）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE"><span class="nav-number">17.</span> <span class="nav-text">视图</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DBA%E5%91%BD%E4%BB%A4"><span class="nav-number">18.</span> <span class="nav-text">DBA命令</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BC%E5%87%BA"><span class="nav-number">18.1.</span> <span class="nav-text">导出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5"><span class="nav-number">18.2.</span> <span class="nav-text">导入</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E4%B8%89%E8%8C%83%E5%BC%8F%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89"><span class="nav-number">19.</span> <span class="nav-text">数据库设计三范式（重点）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F"><span class="nav-number">20.</span> <span class="nav-text">日期</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0%EF%BC%9A"><span class="nav-number">20.0.1.</span> <span class="nav-text">日期函数：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">20.0.2.</span> <span class="nav-text">日期运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8E%E6%97%B6%E9%97%B4%E4%B8%AD%E8%8E%B7%E5%8F%96%E5%85%B6%E4%B8%AD%E7%9A%84%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%8C%E6%AF%94%E5%A6%82%E5%8F%AA%E8%8E%B7%E5%8F%96%E5%B0%8F%E6%97%B6%E3%80%81%E6%9C%88%E4%BB%BD%E7%AD%89%E3%80%82"><span class="nav-number">20.0.3.</span> <span class="nav-text">从时间中获取其中的一部分，比如只获取小时、月份等。</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Wallnut"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Wallnut</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">24</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/drinkwateronly" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;drinkwateronly" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/11/17/MySQL/tutorial/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Wallnut">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wallnut">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="基础教程 | Wallnut">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          基础教程
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2023-11-17 19:21:00 / 修改时间：19:35:57" itemprop="dateCreated datePublished" datetime="2023-11-17T19:21:00+08:00">2023-11-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>DBMS - （执行）-&gt; SQL -(操作) -&gt; DB</p>
<p>增删改查 CRUD: create retrieve update delete</p>
<h1 id="表："><a href="#表：" class="headerlink" title="表："></a>表：</h1><ul>
<li>行-数据&#x2F;记录 data</li>
<li>列：字段<ul>
<li>每个字段包括：字段名、数据类型、约束</li>
</ul>
</li>
</ul>
<p>	</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; mysql -uroot -p123  // 登录mysql</span><br><span class="line">mysql&gt; show databases;  // 查看有哪些数据库</span><br><span class="line">mysql&gt; create database database1; // 创建数据库</span><br><span class="line">mysql&gt; use database1;  // 使用该数据库</span><br><span class="line">mysql&gt; show tables;  // 查看有哪些表</span><br><span class="line">mysql&gt; sources  E:\BaiduNetdiskDownload\05-MySQL\bjpowernode.sql // 导入文件</span><br><span class="line">mysql&gt; drop database database1</span><br></pre></td></tr></table></figure>

<p>表结构</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show tables;</span><br><span class="line">+----------------+</span><br><span class="line">| Tables_in_dljd |</span><br><span class="line">+----------------+</span><br><span class="line">| dept           |</span><br><span class="line">| emp            |</span><br><span class="line">| salgrade       |</span><br><span class="line">+----------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; desc dept;</span><br><span class="line">+--------+-------------+------+-----+---------+-------+</span><br><span class="line">| Field  | Type        | Null | Key | Default | Extra |</span><br><span class="line">+--------+-------------+------+-----+---------+-------+</span><br><span class="line">| DEPTNO | int         | NO   | PRI | NULL    |       | # 部门编号</span><br><span class="line">| DNAME  | varchar(14) | YES  |     | NULL    |       | # 部门名</span><br><span class="line">| LOC    | varchar(13) | YES  |     | NULL    |       | # 部门位置</span><br><span class="line">+--------+-------------+------+-----+---------+-------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; desc emp;</span><br><span class="line">+----------+-------------+------+-----+---------+-------+</span><br><span class="line">| Field    | Type        | Null | Key | Default | Extra |</span><br><span class="line">+----------+-------------+------+-----+---------+-------+</span><br><span class="line">| EMPNO    | int         | NO   | PRI | NULL    |       |</span><br><span class="line">| ENAME    | varchar(10) | YES  |     | NULL    |       |</span><br><span class="line">| JOB      | varchar(9)  | YES  |     | NULL    |       |</span><br><span class="line">| MGR      | int         | YES  |     | NULL    |       |</span><br><span class="line">| HIREDATE | date        | YES  |     | NULL    |       |</span><br><span class="line">| SAL      | double(7,2) | YES  |     | NULL    |       |</span><br><span class="line">| COMM     | double(7,2) | YES  |     | NULL    |       |</span><br><span class="line">| DEPTNO   | int         | YES  |     | NULL    |       |</span><br><span class="line">+----------+-------------+------+-----+---------+-------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; desc salgrade;</span><br><span class="line">+-------+------+------+-----+---------+-------+</span><br><span class="line">| Field | Type | Null | Key | Default | Extra |</span><br><span class="line">+-------+------+------+-----+---------+-------+</span><br><span class="line">| GRADE | int  | YES  |     | NULL    |       | # 薪资等级</span><br><span class="line">| LOSAL | int  | YES  |     | NULL    |       |</span><br><span class="line">| HISAL | int  | YES  |     | NULL    |       | # 最高薪资</span><br><span class="line">+-------+------+------+-----+---------+-------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>查看创建该表时的语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show create table salgrade;</span><br><span class="line">#-----------------------------------------</span><br><span class="line">CREATE TABLE `salgrade` (</span><br><span class="line">  `GRADE` int DEFAULT NULL,</span><br><span class="line">  `LOSAL` int DEFAULT NULL,</span><br><span class="line">  `HISAL` int DEFAULT NULL</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci</span><br></pre></td></tr></table></figure>

<h1 id="sql-语句"><a href="#sql-语句" class="headerlink" title="sql 语句"></a>sql 语句</h1><h2 id="SQL语句分类"><a href="#SQL语句分类" class="headerlink" title="SQL语句分类"></a>SQL语句分类</h2><ul>
<li>DQL（数据查询语言）：查询语句</li>
<li>DML（数据操作语言）：增删改查</li>
<li>DDL（数据定义语言）：对表结构增删改查</li>
<li>TCL （事务控制语言）：commit提交事务，rollback回滚事务</li>
<li>DCL（数据控制语言）：grant授权、revoke撤销授权</li>
</ul>
<p>不区分大小写</p>
<h2 id="查询语句"><a href="#查询语句" class="headerlink" title="查询语句"></a>查询语句</h2><p>基础用法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select field_name1, field_name2 from table_name;</span><br><span class="line">select * from table_name; # 开发中不建议使用，效率低</span><br></pre></td></tr></table></figure>

<p>字段参与运算</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select field_name1 * 12 as field_name3, field_name2 from table_name;</span><br><span class="line">select ename, sal * 12 as yearsal from emp;  # as 可省略</span><br><span class="line">select ename, sal * 12 as &#x27;年薪&#x27; from emp;  # 单引号括起作为字符串，不要用双引号，因为不通用</span><br></pre></td></tr></table></figure>

<p>条件查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select ename from emp where sal = 5000;</span><br><span class="line">select sal from emp where ename = &#x27;king&#x27;;</span><br><span class="line">select ename from emp where sal &lt;&gt; 5000;  # 不等于号 也可以用!=</span><br><span class="line">select ename from emp where sal &gt;= 1000 and sal &lt;= 3000;</span><br><span class="line">select ename from emp where sal between 1000 and 3000;  # 闭区间，且左小右大</span><br><span class="line">select ename from emp where ename between &#x27;A&#x27; and &#x27;B&#x27;;  # 左闭右开，只比了第一个字符</span><br></pre></td></tr></table></figure>

<ul>
<li><p>null不是值，条件查询时不能用等号，只能用<code>is null</code>或<code>is not null</code>，虽然TURNER的comm是0，但不为null	</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select ename, comm from emp where comm is not null;</span><br><span class="line">+--------+---------+</span><br><span class="line">| ename  | comm    |</span><br><span class="line">+--------+---------+</span><br><span class="line">| ALLEN  |  300.00 |</span><br><span class="line">| WARD   |  500.00 |</span><br><span class="line">| MARTIN | 1400.00 |</span><br><span class="line">| TURNER |    0.00 |</span><br><span class="line">+--------+---------+</span><br></pre></td></tr></table></figure>
</li>
<li><p>and优先级大于or，也可以使用小括号给小括号。</p>
</li>
<li><p>in  等同于 or，判断 in 后的的几种值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select ename from emp where sal = 1000 and sal = 3000;</span><br><span class="line">select ename from emp where sal in (1000, 3000, 2000);</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="模糊查询Like"><a href="#模糊查询Like" class="headerlink" title="模糊查询Like"></a>模糊查询Like</h3><ul>
<li>%：表示任意多个字符</li>
<li>_：表示任意一个字符</li>
<li>也可以使用转义字符，查询以上两个字符本身。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select ename from emp where ename like &#x27;%o%&#x27;; # 找到名字带o的</span><br><span class="line">+-------+</span><br><span class="line">| ename |</span><br><span class="line">+-------+</span><br><span class="line">| JONES |</span><br><span class="line">| SCOTT |</span><br><span class="line">| FORD  |</span><br><span class="line">+-------+</span><br><span class="line">mysql&gt; select ename from emp where ename like &#x27;_A%&#x27;; # 找到名字第二个字母为a的</span><br><span class="line">+--------+</span><br><span class="line">| ename  |</span><br><span class="line">+--------+</span><br><span class="line">| WARD   |</span><br><span class="line">| MARTIN |</span><br><span class="line">| JAMES  |</span><br><span class="line">+--------+</span><br></pre></td></tr></table></figure>

<h3 id="数据排序-order-by"><a href="#数据排序-order-by" class="headerlink" title="数据排序 order by"></a>数据排序 order by</h3><p>注意：排序发生在分组之后。</p>
<p>升序asc（默认） &#x2F; 降序desc</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># 默认升序</span><br><span class="line">mysql&gt; select ename,sal from emp order by sal;</span><br><span class="line"># 关键词指定升序降序</span><br><span class="line">mysql&gt; select ename,sal from emp order by sal asc;</span><br><span class="line">mysql&gt; select ename,sal from emp order by sal desc;</span><br><span class="line"># 分段排序，先升序排序sal，若sal相同，则降序排序asc。</span><br><span class="line">select ename,sal from emp order by sal, ename asc;</span><br><span class="line">+--------+---------+</span><br><span class="line">| ename  | sal     |</span><br><span class="line">+--------+---------+</span><br><span class="line">| SMITH  |  800.00 |</span><br><span class="line">| JAMES  |  950.00 |</span><br><span class="line">| ADAMS  | 1100.00 |</span><br><span class="line">| MARTIN | 1250.00 |</span><br><span class="line">| WARD   | 1250.00 |</span><br><span class="line">| MILLER | 1300.00 |</span><br><span class="line">| TURNER | 1500.00 |</span><br><span class="line">| ALLEN  | 1600.00 |</span><br><span class="line">| CLARK  | 2450.00 |</span><br><span class="line">| BLAKE  | 2850.00 |</span><br><span class="line">| JONES  | 2975.00 |</span><br><span class="line">| FORD   | 3000.00 |</span><br><span class="line">| SCOTT  | 3000.00 |</span><br><span class="line">| KING   | 5000.00 |</span><br><span class="line">+--------+---------+</span><br><span class="line"># 先from 后 where 最后 order</span><br><span class="line">select ename, sal from emp where job = &#x27;salesman&#x27; order by sal desc;</span><br><span class="line"># 验证执行顺序</span><br><span class="line">select ename, job, sal as salary from emp where job = &#x27;salesman&#x27; order by salary desc;</span><br></pre></td></tr></table></figure>

<h3 id="分组函数"><a href="#分组函数" class="headerlink" title="分组函数"></a>分组函数</h3><p><strong>分组函数会自动忽略null</strong>。又称为多行执行函数，输入多行输出一行，只有如下五种：</p>
<ul>
<li>sum</li>
<li>avg</li>
<li>max&#x2F;min</li>
<li>count</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select count(*) from emp; #</span><br><span class="line">+----------+</span><br><span class="line">| count(*) |</span><br><span class="line">+----------+</span><br><span class="line">|       14 |</span><br><span class="line">+----------+</span><br><span class="line"># 分组函数自动忽略null，所以count(comm)只有4个。</span><br><span class="line">mysql&gt; select count(comm), sum(comm), avg(comm) from emp;</span><br><span class="line">+-------------+-----------+------------+</span><br><span class="line">| count(comm) | sum(comm) | avg(comm)  |</span><br><span class="line">+-------------+-----------+------------+</span><br><span class="line">|           4 |   2200.00 | 550.000000 |</span><br><span class="line">+-------------+-----------+------------+</span><br><span class="line"># 多余的操作：</span><br><span class="line">mysql&gt; select count(comm) from emp where comm is not null;  </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>区别</p>
<ul>
<li><code>count(comm)</code>统计某个字段的非空数据。</li>
<li><code>count(*)</code>一定是统计总记录条数，而不是某个字段中数据的个数，即与某字段无关，即使为所有字段值都为null。</li>
</ul>
<p>单行处理函数中null的问题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"># 任何数据库，null参与数据运算，最后结果都是null</span><br><span class="line">mysql&gt; select ename, (sal+comm) * 12 as yearsal from emp;</span><br><span class="line">+--------+----------+</span><br><span class="line">| ename  | yearsal  |</span><br><span class="line">+--------+----------+</span><br><span class="line">| SMITH  |     NULL |</span><br><span class="line">| ALLEN  | 22800.00 |</span><br><span class="line">| WARD   | 21000.00 |</span><br><span class="line">| JONES  |     NULL |</span><br><span class="line">| MARTIN | 31800.00 |</span><br><span class="line">| BLAKE  |     NULL |</span><br><span class="line">| CLARK  |     NULL |</span><br><span class="line">| SCOTT  |     NULL |</span><br><span class="line">| KING   |     NULL |</span><br><span class="line">| TURNER | 18000.00 |</span><br><span class="line">| ADAMS  |     NULL |</span><br><span class="line">| JAMES  |     NULL |</span><br><span class="line">| FORD   |     NULL |</span><br><span class="line">| MILLER |     NULL |</span><br><span class="line">+--------+----------+</span><br><span class="line"># 解决方式，ifnull()函数</span><br><span class="line">	# 用法：ifnull(可能是空的数据，若是空被替换的数据)</span><br><span class="line">mysql&gt; select ename, (sal+ifnull(comm,0)) * 12 as yearsal from emp;</span><br><span class="line">+--------+----------+</span><br><span class="line">| ename  | yearsal  |</span><br><span class="line">+--------+----------+</span><br><span class="line">| SMITH  |  9600.00 |</span><br><span class="line">| ALLEN  | 22800.00 |</span><br><span class="line">| WARD   | 21000.00 |</span><br><span class="line">| JONES  | 35700.00 |</span><br><span class="line">| MARTIN | 31800.00 |</span><br><span class="line">| BLAKE  | 34200.00 |</span><br><span class="line">| CLARK  | 29400.00 |</span><br><span class="line">| SCOTT  | 36000.00 |</span><br><span class="line">| KING   | 60000.00 |</span><br><span class="line">| TURNER | 18000.00 |</span><br><span class="line">| ADAMS  | 13200.00 |</span><br><span class="line">| JAMES  | 11400.00 |</span><br><span class="line">| FORD   | 36000.00 |</span><br><span class="line">| MILLER | 15600.00 |</span><br><span class="line">+--------+----------+</span><br></pre></td></tr></table></figure>

<h4 id="group-by-和-having"><a href="#group-by-和-having" class="headerlink" title="group by 和 having"></a>group by 和 having</h4><ul>
<li>group by： 按照某个&#x2F;些字段进行分组</li>
<li>having：对分组后的数据再次过滤，<ul>
<li><u>作用和where类似，但having一定和group by一起用。</u></li>
<li><u>where在group by执行前执行，having则在group by执行后执行。</u></li>
<li><u>为了效率尽量使用where先过滤 而非having后过滤。</u></li>
</ul>
</li>
</ul>
<h5 id="group-by"><a href="#group-by" class="headerlink" title="group by"></a>group by</h5><p><em><u>当一条语句有group by分组，select后只能跟分组函数和参与分组的字段</u>。</em></p>
<p>见问题与解决方法.md文件的错误2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 找出每个工作岗位的最高薪资</span><br><span class="line">mysql&gt; select max(sal), job from emp group by job;</span><br><span class="line">+----------+-----------+</span><br><span class="line">| max(sal) | job       |</span><br><span class="line">+----------+-----------+</span><br><span class="line">|  1300.00 | CLERK     |</span><br><span class="line">|  1600.00 | SALESMAN  |</span><br><span class="line">|  2975.00 | MANAGER   |</span><br><span class="line">|  3000.00 | ANALYST   |</span><br><span class="line">|  5000.00 | PRESIDENT |</span><br><span class="line">+----------+-----------+</span><br><span class="line"></span><br><span class="line"># 找出每个工作岗位的最高薪资, 多查询了ename字段，Oracle会报错，mysql可执行但无意义，数据是错误的（此处新版本会报错）</span><br><span class="line">mysql&gt; select ename, max(sal), job from emp group by job;</span><br><span class="line"># 当一条语句有group by，select后只能跟分组函数和参与分组的字段。</span><br></pre></td></tr></table></figure>

<p>多个字段联合分组：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select deptno, job, sal from emp order by deptno, job;</span><br><span class="line">+--------+-----------+---------+</span><br><span class="line">| deptno | job       | sal     |</span><br><span class="line">+--------+-----------+---------+</span><br><span class="line">|     10 | CLERK     | 1300.00 |</span><br><span class="line">|     10 | MANAGER   | 2450.00 |</span><br><span class="line">|     10 | PRESIDENT | 5000.00 |</span><br><span class="line">|     20 | ANALYST   | 3000.00 |</span><br><span class="line">|     20 | ANALYST   | 3000.00 |</span><br><span class="line">|     20 | CLERK     |  800.00 |</span><br><span class="line">|     20 | CLERK     | 1100.00 |</span><br><span class="line">|     20 | MANAGER   | 2975.00 |</span><br><span class="line">|     30 | CLERK     |  950.00 |</span><br><span class="line">|     30 | MANAGER   | 2850.00 |</span><br><span class="line">|     30 | SALESMAN  | 1600.00 |</span><br><span class="line">|     30 | SALESMAN  | 1250.00 |</span><br><span class="line">|     30 | SALESMAN  | 1250.00 |</span><br><span class="line">|     30 | SALESMAN  | 1500.00 |</span><br><span class="line">+--------+-----------+---------+</span><br><span class="line"># 找出每个部门deptno中，不同工作岗位job最高薪资</span><br><span class="line">mysql&gt; select deptno, job, max(sal) from emp group by deptno,job order by deptno, job;</span><br><span class="line">+--------+-----------+----------+</span><br><span class="line">| deptno | job       | max(sal) |</span><br><span class="line">+--------+-----------+----------+</span><br><span class="line">|     10 | CLERK     |  1300.00 |</span><br><span class="line">|     10 | MANAGER   |  2450.00 |</span><br><span class="line">|     10 | PRESIDENT |  5000.00 |</span><br><span class="line">|     20 | ANALYST   |  3000.00 |</span><br><span class="line">|     20 | CLERK     |  1100.00 |</span><br><span class="line">|     20 | MANAGER   |  2975.00 |</span><br><span class="line">|     30 | CLERK     |   950.00 |</span><br><span class="line">|     30 | MANAGER   |  2850.00 |</span><br><span class="line">|     30 | SALESMAN  |  1600.00 |</span><br><span class="line">+--------+-----------+----------+</span><br></pre></td></tr></table></figure>

<h5 id="having"><a href="#having" class="headerlink" title="having"></a>having</h5><p>为了过滤分组后的数据而存在，不可以单独出现。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># 找出每个部分的最高薪资，要求显示薪资大于2900的数据</span><br><span class="line"># having</span><br><span class="line">mysql&gt; select max(sal), deptno from emp group by deptno having max(sal) &gt; 2900;</span><br><span class="line">+----------+--------+</span><br><span class="line">| max(sal) | deptno |</span><br><span class="line">+----------+--------+</span><br><span class="line">|  3000.00 |     20 |</span><br><span class="line">|  5000.00 |     10 |</span><br><span class="line">+----------+--------+</span><br><span class="line"># where</span><br><span class="line">mysql&gt; select max(sal), deptno from emp where sal &gt; 2900 group by deptno;</span><br><span class="line">+----------+--------+</span><br><span class="line">| max(sal) | deptno |</span><br><span class="line">+----------+--------+</span><br><span class="line">|  3000.00 |     20 |</span><br><span class="line">|  5000.00 |     10 |</span><br><span class="line">+----------+--------+</span><br></pre></td></tr></table></figure>

<ul>
<li>此处having效率比where低，因为where对过滤的数据分组，再执行分组函数；而having执行了分组函数后，才进行过滤。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 找出每个部门的平均薪资，要求显示薪资大于2000的数据</span><br><span class="line">mysql&gt; select avg(sal), deptno from emp group by deptno having avg(sal) &gt; 2000;</span><br><span class="line">+-------------+--------+</span><br><span class="line">| avg(sal)    | deptno |</span><br><span class="line">+-------------+--------+</span><br><span class="line">| 2175.000000 |     20 |</span><br><span class="line">| 2916.666667 |     10 |</span><br><span class="line">+-------------+--------+</span><br></pre></td></tr></table></figure>

<ul>
<li>此处只能用having，而无法使用where过滤，原因如下：</li>
</ul>
<h5 id="分组函数不能直接使用在where语句。"><a href="#分组函数不能直接使用在where语句。" class="headerlink" title="分组函数不能直接使用在where语句。"></a><strong>分组函数不能直接使用在where语句。</strong></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 找出工资大于平均工资的员工</span><br><span class="line">select ename, sal from emp where sal &gt; avg(sal);  # ERROR 1111 (HY000): Invalid use of group function</span><br></pre></td></tr></table></figure>

<p>原因：</p>
<ul>
<li>执行顺序为：where-&gt;group by-&gt;分组函数，<strong>分组函数一般都会和group by 联合使用，并在group by执行后执行</strong>，可以认为没用group by时，整张表也会使用一个默认的group by自成一组。所以where内不能用分组函数，因为还没有group by分组。</li>
</ul>
<p>解决方法：使用子查询语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 找出工资大于平均工资的员工</span><br><span class="line">mysql&gt; select ename, sal from emp where sal &gt; (select avg(sal) from emp);</span><br><span class="line">+-------+---------+</span><br><span class="line">| ename | sal     |</span><br><span class="line">+-------+---------+</span><br><span class="line">| JONES | 2975.00 |</span><br><span class="line">| BLAKE | 2850.00 |</span><br><span class="line">| CLARK | 2450.00 |</span><br><span class="line">| SCOTT | 3000.00 |</span><br><span class="line">| KING  | 5000.00 |</span><br><span class="line">| FORD  | 3000.00 |</span><br><span class="line">+-------+---------+</span><br></pre></td></tr></table></figure>

<h3 id="去重distinct"><a href="#去重distinct" class="headerlink" title="去重distinct"></a>去重distinct</h3><p>只能出现在所有字段最前面，表示对后面的字段联合去重，联合起来的字段一起相同才会被去除</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select distinct job from emp;</span><br><span class="line">+-----------+</span><br><span class="line">| job       |</span><br><span class="line">+-----------+</span><br><span class="line">| CLERK     |</span><br><span class="line">| SALESMAN  |</span><br><span class="line">| MANAGER   |</span><br><span class="line">| ANALYST   |</span><br><span class="line">| PRESIDENT |</span><br><span class="line">+-----------+</span><br><span class="line"># distinct 只能出现在所有字段最前面，表示对后面的字段联合去重</span><br><span class="line">mysql&gt; select distinct deptno, job from emp order by deptno;</span><br><span class="line">+--------+-----------+</span><br><span class="line">| deptno | job       |</span><br><span class="line">+--------+-----------+</span><br><span class="line">|     10 | CLERK     |</span><br><span class="line">|     10 | MANAGER   |</span><br><span class="line">|     10 | PRESIDENT |</span><br><span class="line">|     20 | ANALYST   |</span><br><span class="line">|     20 | CLERK     |</span><br><span class="line">|     20 | MANAGER   |</span><br><span class="line">|     30 | CLERK     |</span><br><span class="line">|     30 | MANAGER   |</span><br><span class="line">|     30 | SALESMAN  |</span><br><span class="line">+--------+-----------+</span><br><span class="line"># 统计岗位的数量，distinct输出是多行，所以可以直接交给分组函数</span><br><span class="line">mysql&gt; select count(distinct job) from emp;</span><br><span class="line">+---------------------+</span><br><span class="line">| count(distinct job) |</span><br><span class="line">+---------------------+</span><br><span class="line">|                   5 |</span><br><span class="line">+---------------------+ </span><br></pre></td></tr></table></figure>



<h2 id="cast"><a href="#cast" class="headerlink" title="cast"></a>cast</h2><p>CAST函数用于将值从一种数据类型转换为表达式中指定的另一种数据类型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CAST(value AS datatype)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/drinkwateronly/Image-Host/main/iimage/image-20230914000048586.png" alt="image-20230914000048586"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT CAST(&#x27;2022-04-27&#x27; AS DATETIME); </span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h2><p>实际开发中一般是多表联合查询出最终的结果</p>
<h3 id="连接查询分类"><a href="#连接查询分类" class="headerlink" title="连接查询分类"></a>连接查询分类</h3><ul>
<li>语法<ul>
<li>SQL92</li>
<li>SQL99</li>
</ul>
</li>
<li>连接方式<ul>
<li>内连接<ul>
<li>等值连接</li>
<li>非等值连接</li>
<li>自连接</li>
</ul>
</li>
<li>外连接<ul>
<li>左外&#x2F;左连接</li>
<li>右外&#x2F;有链接</li>
</ul>
</li>
<li>全连接（很少用</li>
</ul>
</li>
</ul>
<p>表连接的现象：笛卡尔积现象</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 两张表联合查询没有限制条件，结果的条数是两张表条 数的乘积</span><br><span class="line">mysql&gt; select ename,dname from emp,dept;</span><br></pre></td></tr></table></figure>

<p>避免笛卡尔积现象的直接方式是使用条件过滤，但不会减少记录的匹配次数，只会显示有效的记录。</p>
<p>此外此处使用了表的别名，执行效率高，可读性高</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 找出每个员工的姓名与部门名</span><br><span class="line">mysql&gt; select e.ename, d.dname from emp e, dept d where e.deptno = d.deptno;  #sql92写法，不使用</span><br><span class="line">+--------+------------+</span><br><span class="line">| ename  | dname      |</span><br><span class="line">+--------+------------+</span><br><span class="line">| SMITH  | RESEARCH   |</span><br><span class="line">| ALLEN  | SALES      |</span><br><span class="line">| WARD   | SALES      |</span><br><span class="line">| JONES  | RESEARCH   |</span><br><span class="line">| MARTIN | SALES      |</span><br><span class="line">| BLAKE  | SALES      |</span><br><span class="line">| CLARK  | ACCOUNTING |</span><br><span class="line">| SCOTT  | RESEARCH   |</span><br><span class="line">| KING   | ACCOUNTING |</span><br><span class="line">| TURNER | SALES      |</span><br><span class="line">| ADAMS  | RESEARCH   |</span><br><span class="line">| JAMES  | SALES      |</span><br><span class="line">| FORD   | RESEARCH   |</span><br><span class="line">| MILLER | ACCOUNTING |</span><br><span class="line">+--------+------------+</span><br><span class="line">14 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>



<h3 id="内连接——等值连接：条件是等量关系"><a href="#内连接——等值连接：条件是等量关系" class="headerlink" title="内连接——等值连接：条件是等量关系"></a>内连接——等值连接：条件是等量关系</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> # sql99语法，where和连接的条件分离了，更常用</span><br><span class="line"> # 语法： mysql&gt; ... A join B on 连接条件 where ...</span><br><span class="line">mysql&gt; select e.ename, d.dname from emp e join dept d on e.deptno = d.deptno;</span><br><span class="line"> # inner可以省略，带着inner可读性更好</span><br><span class="line">mysql&gt; select e.ename, d.dname from emp e inner join dept d on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>

<h3 id="内连接——非等值连接"><a href="#内连接——非等值连接" class="headerlink" title="内连接——非等值连接"></a>内连接——非等值连接</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 找出每个员工的工资等级，要求显示员工名，工资，工资等级</span><br><span class="line">mysql&gt; select e.ename,e.sal,s.grade from emp e inner join salgrade s on e.sal between s.losal and s.hisal;</span><br><span class="line">+--------+---------+-------+</span><br><span class="line">| ename  | sal     | grade |</span><br><span class="line">+--------+---------+-------+</span><br><span class="line">| SMITH  |  800.00 |     1 |</span><br><span class="line">| ALLEN  | 1600.00 |     3 |</span><br><span class="line">| WARD   | 1250.00 |     2 |</span><br><span class="line">| JONES  | 2975.00 |     4 |</span><br><span class="line">| MARTIN | 1250.00 |     2 |</span><br><span class="line">| BLAKE  | 2850.00 |     4 |</span><br><span class="line">| CLARK  | 2450.00 |     4 |</span><br><span class="line">| SCOTT  | 3000.00 |     4 |</span><br><span class="line">| KING   | 5000.00 |     5 |</span><br><span class="line">| TURNER | 1500.00 |     3 |</span><br><span class="line">| ADAMS  | 1100.00 |     1 |</span><br><span class="line">| JAMES  |  950.00 |     1 |</span><br><span class="line">| FORD   | 3000.00 |     4 |</span><br><span class="line">| MILLER | 1300.00 |     2 |</span><br><span class="line">+--------+---------+-------+</span><br></pre></td></tr></table></figure>

<h3 id="自连接：一张表看成两张表，自己连接自己。"><a href="#自连接：一张表看成两张表，自己连接自己。" class="headerlink" title="自连接：一张表看成两张表，自己连接自己。"></a>自连接：一张表看成两张表，自己连接自己。</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 找出每个员工上级领导，要求显示员工名和对应领导名</span><br><span class="line">mysql&gt; select a.ename,b.ename from emp a inner join emp b on a.mgr = b.empno;</span><br><span class="line">+--------+-------+</span><br><span class="line">| ename  | ename |</span><br><span class="line">+--------+-------+</span><br><span class="line">| SMITH  | FORD  |</span><br><span class="line">| ALLEN  | BLAKE |</span><br><span class="line">| WARD   | BLAKE |</span><br><span class="line">| JONES  | KING  |</span><br><span class="line">| MARTIN | BLAKE |</span><br><span class="line">| BLAKE  | KING  |</span><br><span class="line">| CLARK  | KING  |</span><br><span class="line">| SCOTT  | JONES |</span><br><span class="line">| TURNER | BLAKE |</span><br><span class="line">| ADAMS  | SCOTT |</span><br><span class="line">| JAMES  | BLAKE |</span><br><span class="line">| FORD   | JONES |</span><br><span class="line">| MILLER | CLARK |</span><br><span class="line">+--------+-------+</span><br><span class="line"># a是员工表，b是领导表，实际上是一张表，因为员工和领导都在一张表里</span><br><span class="line"># 因此join的条件是 a.mgr领导编号 = b.empno 员工编号</span><br></pre></td></tr></table></figure>

<h3 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h3><p>A B表内连接时：</p>
<ul>
<li>内连接：凡是A和B匹配的记录就能被查询出来，AB没有主副之分，两表平等</li>
<li>外连接：有主副之分，主要查询主表，如果副表中的数据没有和主表匹配上，副表自动模拟出NULL与之匹配。<ul>
<li>左外连接：左边表是主表</li>
<li>右外连接：右表是主表</li>
<li>左连接会有右连接的写法，右连接会有左连接的写法</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 找出每个员工的上级领导，没有上级领导时该字段为null。</span><br><span class="line">mysql&gt; select a.ename &#x27;员工&#x27;, b.ename &#x27;领导&#x27; from emp a left join emp b on a.mgr = b.empno;  </span><br><span class="line">+--------+-------+</span><br><span class="line">| 员工   | 领导  |</span><br><span class="line">+--------+-------+</span><br><span class="line">| SMITH  | FORD  |</span><br><span class="line">| ALLEN  | BLAKE |</span><br><span class="line">| WARD   | BLAKE |</span><br><span class="line">| JONES  | KING  |</span><br><span class="line">| MARTIN | BLAKE |</span><br><span class="line">| BLAKE  | KING  |</span><br><span class="line">| CLARK  | KING  |</span><br><span class="line">| SCOTT  | JONES |</span><br><span class="line">| KING   | NULL  |  # king是老板，所以没有上级领导</span><br><span class="line">| TURNER | BLAKE |</span><br><span class="line">| ADAMS  | SCOTT |</span><br><span class="line">| JAMES  | BLAKE |</span><br><span class="line">| FORD   | JONES |</span><br><span class="line">| MILLER | CLARK |</span><br><span class="line">+--------+-------+</span><br><span class="line">mysql&gt; select a.ename &#x27;员工&#x27;, b.ename &#x27;领导&#x27; from emp a left outer join emp b on a.mgr = b.empno;  # outer可以省略</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># 找出没有员工的部门</span><br><span class="line"># 左连接</span><br><span class="line">mysql&gt; select d.deptno, d.dname from dept d left outer join emp e on d.deptno = e.deptno where e.empno is null;</span><br><span class="line">+--------+------------+</span><br><span class="line">| deptno | dname      |</span><br><span class="line">+--------+------------+</span><br><span class="line">|     40 | OPERATIONS |</span><br><span class="line">+--------+------------+</span><br><span class="line"># 右连接</span><br><span class="line">mysql&gt; select d.deptno, d.dname from emp e right outer join dept d on d.deptno = e.deptno where e.empno is null;</span><br><span class="line">+--------+------------+</span><br><span class="line">| deptno | dname      |</span><br><span class="line">+--------+------------+</span><br><span class="line">|     40 | OPERATIONS |</span><br><span class="line">+--------+------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="三张表连接"><a href="#三张表连接" class="headerlink" title="三张表连接"></a>三张表连接</h3><p><code>select ...from A join B on ... join C on ...</code> ，A先跟B再跟C连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"># 找出每个员工的部门名称 以及 工资等级</span><br><span class="line">mysql&gt; select e.ename, d.dname, s.grade </span><br><span class="line">from emp e </span><br><span class="line">join dept d on e.deptno = d.deptno </span><br><span class="line">join salgrade s on e.sal between s.losal and s.hisal;</span><br><span class="line">+--------+------------+-------+</span><br><span class="line">| ename  | dname      | grade |</span><br><span class="line">+--------+------------+-------+</span><br><span class="line">| SMITH  | RESEARCH   |     1 |</span><br><span class="line">| ALLEN  | SALES      |     3 |</span><br><span class="line">| WARD   | SALES      |     2 |</span><br><span class="line">| JONES  | RESEARCH   |     4 |</span><br><span class="line">| MARTIN | SALES      |     2 |</span><br><span class="line">| BLAKE  | SALES      |     4 |</span><br><span class="line">| CLARK  | ACCOUNTING |     4 |</span><br><span class="line">| SCOTT  | RESEARCH   |     4 |</span><br><span class="line">| KING   | ACCOUNTING |     5 |</span><br><span class="line">| TURNER | SALES      |     3 |</span><br><span class="line">| ADAMS  | RESEARCH   |     1 |</span><br><span class="line">| JAMES  | SALES      |     1 |</span><br><span class="line">| FORD   | RESEARCH   |     4 |</span><br><span class="line">| MILLER | ACCOUNTING |     2 |</span><br><span class="line">+--------+------------+-------+</span><br><span class="line"># 找出每个员工的部门名称、 工资等级、 以及上级领导</span><br><span class="line">mysql&gt; select e.ename, d.dname, s.grade, ee.ename &#x27;领导&#x27;</span><br><span class="line">    -&gt; from emp e</span><br><span class="line">    -&gt; join dept d on e.deptno = d.deptno</span><br><span class="line">    -&gt; join salgrade s on e.sal between s.losal and s.hisal</span><br><span class="line">    -&gt; left join emp ee on e.mgr = ee.empno;</span><br><span class="line">+--------+------------+-------+-------+</span><br><span class="line">| ename  | dname      | grade | 领导  |</span><br><span class="line">+--------+------------+-------+-------+</span><br><span class="line">| SMITH  | RESEARCH   |     1 | FORD  |</span><br><span class="line">| ALLEN  | SALES      |     3 | BLAKE |</span><br><span class="line">| WARD   | SALES      |     2 | BLAKE |</span><br><span class="line">| JONES  | RESEARCH   |     4 | KING  |</span><br><span class="line">| MARTIN | SALES      |     2 | BLAKE |</span><br><span class="line">| BLAKE  | SALES      |     4 | KING  |</span><br><span class="line">| CLARK  | ACCOUNTING |     4 | KING  |</span><br><span class="line">| SCOTT  | RESEARCH   |     4 | JONES |</span><br><span class="line">| KING   | ACCOUNTING |     5 | NULL  |</span><br><span class="line">| TURNER | SALES      |     3 | BLAKE |</span><br><span class="line">| ADAMS  | RESEARCH   |     1 | SCOTT |</span><br><span class="line">| JAMES  | SALES      |     1 | BLAKE |</span><br><span class="line">| FORD   | RESEARCH   |     4 | JONES |</span><br><span class="line">| MILLER | ACCOUNTING |     2 | CLARK |</span><br><span class="line">+--------+------------+-------+-------+</span><br></pre></td></tr></table></figure>

<h3 id="全连接"><a href="#全连接" class="headerlink" title="全连接"></a>全连接</h3><p>实际上是外连接时，左右表都实行左右外联，使得如果 “left_table” 表中的行在 “right_table” 中没有匹配或者 “right_table” 表中的行在</p>
<p>“left_table” 表中没有匹配，也会列出这些行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># key word：</span><br><span class="line">full join</span><br></pre></td></tr></table></figure>





<p>insert into student_table values(‘1009’ , ‘李四’, ‘2000-01-01’, ‘男’);<br>insert into student_table values(‘1010’ , ‘李四’, ‘2001-01-01’, ‘男’);<br>insert into student_table values(‘1006’ , ‘王五’, ‘2000-08-06’ , ‘女’);<br>insert into student_table values(‘1008’ , ‘张三’, ‘2002-12-01’, ‘女’);<br>insert into student_table values(‘1012’ , ‘张三’, ‘2001-12-01’, ‘女’);<br>insert into student_table values(‘1011’ , ‘李四’, ‘2002-08-06’ , ‘女’);<br>insert into student_table values(‘1013’ , ‘赵六’ ,’2000-09-06’ , ‘男’);</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">select * from</span><br><span class="line"></span><br><span class="line">select t1.*,t2.*</span><br><span class="line">from (</span><br><span class="line">select * from student_table where sex = &#x27;男&#x27; ) t1 </span><br><span class="line">left join </span><br><span class="line">(select * from student_table where sex = &#x27;女&#x27;) t2 </span><br><span class="line">on t1.name = t2.name </span><br><span class="line"></span><br><span class="line">union all</span><br><span class="line"></span><br><span class="line">select t1.*,t2.*</span><br><span class="line">from (</span><br><span class="line">select * from student_table where sex = &#x27;男&#x27; ) t1 </span><br><span class="line">right join </span><br><span class="line">(select * from student_table where sex = &#x27;女&#x27;) t2 </span><br><span class="line">on t1.name = t2.name;</span><br></pre></td></tr></table></figure>



<p>select t1.<em>,t2.</em><br>from (<br>select * from student_table where sex &#x3D; ‘男’ ) t1<br>left join<br>(select * from student_table where sex &#x3D; ‘女’)t2<br>on t1.name &#x3D; t2.name<br>union<br>select t1.<em>,t2.</em><br>from (<br>select * from student_table where sex &#x3D; ‘男’ ) t1<br>right join<br>(select * from student_table where sex &#x3D; ‘女’)t2<br>on t1.name &#x3D; t2.name;</p>
<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><p>select中嵌套select，被嵌套的select语句称为子查询。理解为：select后就是一张临时的新表。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">	..(select)..</span><br><span class="line">from</span><br><span class="line">	..(select)..  # 查询结果将会当成临时表</span><br><span class="line">where</span><br><span class="line">	..(select)..</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"># where：找出高于平均薪资的员工信息</span><br><span class="line">mysql&gt; select * from emp where sal &gt; (select avg(sal) from emp);</span><br><span class="line"># from：找出每个部门平均薪水的薪资等级</span><br><span class="line">select a.avgsal, s.grade </span><br><span class="line">from (select avg(sal) avgsal from emp group by deptno) a </span><br><span class="line">join salgrade s </span><br><span class="line">where a.avgsal between s.losal and s.hisal ;</span><br><span class="line">+-------------+-------+</span><br><span class="line">| avgsal      | grade |</span><br><span class="line">+-------------+-------+</span><br><span class="line">| 2175.000000 |     4 |</span><br><span class="line">| 1566.666667 |     3 |</span><br><span class="line">| 2916.666667 |     4 |</span><br><span class="line">+-------------+-------+</span><br><span class="line"></span><br><span class="line"># 找出每个部门平均的薪资等级</span><br><span class="line"># 正确结果，但错误写法，因为没必要from后当成临时表</span><br><span class="line">mysql&gt; select avg(tmp.grade) </span><br><span class="line">	from </span><br><span class="line">(select e.ename, s.grade, e.deptno from emp e join salgrade s on e.sal between s.losal and s.hisal) tmp </span><br><span class="line">	group by tmp.deptno;</span><br><span class="line">+----------------+</span><br><span class="line">| avg(tmp.grade) |</span><br><span class="line">+----------------+</span><br><span class="line">|         2.8000 |</span><br><span class="line">|         2.5000 |</span><br><span class="line">|         3.6667 |</span><br><span class="line">+----------------+</span><br><span class="line"># select时，s.grade，e.deptno信息已经存在，没必要当成临时表tmp再嵌套</span><br><span class="line">select avg(s.grade), e.deptno from emp e join salgrade s on e.sal between s.losal and s.hisal group by e.deptno;</span><br></pre></td></tr></table></figure>



<h2 id="union"><a href="#union" class="headerlink" title="union"></a>union</h2><p>可以将查询结果集相加，默认去重</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 找出工作岗位是SALESMAN和MANAGER的员工</span><br><span class="line">select * from emp where job = &#x27;MANAGER&#x27; or job = &#x27;SALESMAN&#x27;;</span><br><span class="line">select * from emp where job in (&#x27;MANAGER&#x27;, &#x27;SALESMAN&#x27;);</span><br><span class="line"></span><br><span class="line">select * from emp where job = &#x27;MANAGER&#x27; </span><br><span class="line">union</span><br><span class="line">select * from emp where job = &#x27;SALESMAN&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select ...</span><br><span class="line">union all # 不去重</span><br><span class="line">select ...</span><br></pre></td></tr></table></figure>



<p>union可以解决 or 和 in 无法解决的：两张不相干的表中数据拼接在一起，虽然可能意义不大。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 没有意义，但能拼接，列数不同不能拼接</span><br><span class="line">select ename from emp</span><br><span class="line">union</span><br><span class="line">select dname from dept;</span><br></pre></td></tr></table></figure>



<p>union中只能在最后有一个order by排序，除非对其中一个select加括号，将order by放入其中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 不合法</span><br><span class="line">select ... order by ...</span><br><span class="line">union</span><br><span class="line">select ... order by ...</span><br><span class="line"># 合法，先对第一个select的排序，然后对union后的整体排序</span><br><span class="line">(select ... order by ...)</span><br><span class="line">union</span><br><span class="line">select ... order by ...</span><br><span class="line"># 合法，先括号子查询，后union</span><br><span class="line">(select ... order by ...)</span><br><span class="line">union</span><br><span class="line">(select ... order by ...)</span><br><span class="line">order by ...</span><br></pre></td></tr></table></figure>



<h2 id="limit（特有）"><a href="#limit（特有）" class="headerlink" title="limit（特有）"></a>limit（特有）</h2><p>作用：取部分数据。</p>
<p>mysql特有，也是sql语句最后执行的环节，oracle有相同的机制<code>rownum</code>，分页查询用。</p>
<p>语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">limit startIndex, length</span><br><span class="line"># startIndex表示起始位置</span><br><span class="line"># length表示取几个</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 找出工资前五名的员工</span><br><span class="line">mysql&gt; select ename, sal from emp order by sal desc limit 0, 5;</span><br><span class="line">+-------+---------+</span><br><span class="line">| ename | sal     |</span><br><span class="line">+-------+---------+</span><br><span class="line">| KING  | 5000.00 |</span><br><span class="line">| SCOTT | 3000.00 |</span><br><span class="line">| FORD  | 3000.00 |</span><br><span class="line">| JONES | 2975.00 |</span><br><span class="line">| BLAKE | 2850.00 |</span><br><span class="line">+-------+---------+</span><br><span class="line"># 默认从0开始</span><br><span class="line">mysql&gt; select ename, sal from emp order by sal desc limit 5;</span><br></pre></td></tr></table></figure>

<p>每页显示pageSize条记录：<code>( pageNo - 1) * pageSize, pageSize</code></p>
<h2 id="文本处理"><a href="#文本处理" class="headerlink" title="文本处理"></a>文本处理</h2><p>1、LOCATE(substr , str )：返回子串 substr 在字符串 str 中第一次出现的位置，如果字符substr在字符串str中不存在，则返回0；</p>
<p>2、POSITION(substr IN str )：返回子串 substr 在字符串 str 中第一次出现的位置，如果字符substr在字符串str中不存在，与LOCATE函数作用相同；</p>
<p>3、LEFT(str, length)：从左边开始截取str，length是截取的长度；</p>
<p>4、RIGHT(str, length)：从右边开始截取str，length是截取的长度；</p>
<p>5、SUBSTRING_INDEX(str ,substr ,n)：</p>
<ul>
<li><p>当n&gt;0，返回字符substr在str中从左到右第n次出现位置之前的字符串;</p>
</li>
<li><p>当n&lt;0，返回字符substr在str中从右到左第n次出现位置之后的字符串;</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/a5475ed3b5ab4de58e2ea426b4b2db76?tpId=240&tqId=2202382&ru=/practice/255aa1863fe14aa88694c09ebbc1dbca&qru=/ta/sql-advanced/question-ranking&sourceUrl=/exam/oj">修复串列了的记录_牛客题霸_牛客网 (nowcoder.com)</a></p>
</li>
</ul>
<p>6、SUBSTRING(str ,n ,m)：返回字符串str从第n个字符截取到第m个字符；</p>
<p>7、REPLACE(str, n, m)：将字符串str中的n字符替换成m字符；</p>
<p>8、LENGTH(str)：计算字符串str的长度。</p>
<p>9、CONCAT(字段A, 分隔符, 字段B)</p>
<p>10、GROUP_CONCAT(字段名 SEPARATOR ‘;’) 和GROUP_BY一起使用，将同一组内同一字段的所有数据连接，默认以逗号作为分隔符，若要指定分隔符 加上<code>SEPARATOR &#39;;&#39;</code>即可，注意没有逗号。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/46cb7a33f7204f3ba7f6536d2fc04286?tpId=240&tqId=2183007&ru=/practice/f6b4770f453d4163acc419e3d19e6746&qru=/ta/sql-advanced/question-ranking&sourceUrl=/exam/oj">	未完成试卷数大于1的有效用户_牛客题霸_牛客网 (nowcoder.com)</a></li>
</ul>
<h1 id="建表"><a href="#建表" class="headerlink" title="建表"></a>建表</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table 表名(</span><br><span class="line">    字段名1 数据类型,</span><br><span class="line">    字段名2 数据类型,</span><br><span class="line">    字段名3 数据类型,</span><br><span class="line">    ....);</span><br></pre></td></tr></table></figure>

<p>关于MySQL当中字段的数据类型？</p>
<ul>
<li>int		整数型</li>
<li>bigint	长整型</li>
<li>float		浮点型</li>
<li>char		定长字符串<strong>（字段长度定长时，如性别、日期1999-01-01等）</strong></li>
<li>varchar	可变长字符串<strong>（字段长度不确定时，如姓名等）</strong></li>
<li>date		日期类型 </li>
<li>BLOB		二进制大对象（存储图片、视频等流媒体信息） </li>
<li>CLOB		字符大对象（存储较大文本，比如，可以存储4G的字符串。）</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 创建学生表：学号、姓名、性别、班级编号、生日</span><br><span class="line">create table t_student(</span><br><span class="line">    no bigint,</span><br><span class="line">    name varchar(255),</span><br><span class="line">    sex char(1) default,</span><br><span class="line">    classno varchar(255),</span><br><span class="line">    birth char(10)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<p>建表后单独加外键约束</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名 </span><br><span class="line">ADD CONSTRAINT 外键名 </span><br><span class="line">FOREIGN KEY (本表外键列名) </span><br><span class="line">REFERENCES 主表名(主表主键列名)</span><br></pre></td></tr></table></figure>





<h1 id="插入Insert"><a href="#插入Insert" class="headerlink" title="插入Insert"></a>插入Insert</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 插入时，指定字段</span><br><span class="line">insert into table1 (file1, file2, ...) values (value1, value2, ...);</span><br><span class="line"># 插入时，指定字段，插入多行</span><br><span class="line">insert into table1 (file1, file2, ...) values (value1, value2, ...),(value1, value2, ...),(value1, value2, ...);</span><br><span class="line"># 省略字段</span><br><span class="line">insert into table1 values (value1, value2, ...);</span><br></pre></td></tr></table></figure>

<p>指定字段插入时，value 和 file的类型要一一对应，可以颠倒字段顺序；如果此时某些file没填入，value则为字段的默认值，如果未指定默认值则为<code>NULL</code>。</p>
<p>当字段省略时，所有的value都要填入，否则报错。主键可以设置为null，因为会自增。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">replace into</span><br></pre></td></tr></table></figure>

<p>语法和insert into一致，作用是试图插入，若其中某个value的对应字段是unique的话且value重复的话，则找到这个value对应的记录，并update；否则执行插入操作。</p>
<h1 id="表的复制"><a href="#表的复制" class="headerlink" title="表的复制"></a>表的复制</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 根据select的查询结果当作表，创建出table1</span><br><span class="line">create table table1 as select * from t_student;</span><br></pre></td></tr></table></figure>

<h1 id="查询结果插入到另一个表中"><a href="#查询结果插入到另一个表中" class="headerlink" title="查询结果插入到另一个表中"></a>查询结果插入到另一个表中</h1><p>字段数要相同</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into t_tmp select * from t_student;</span><br></pre></td></tr></table></figure>



<h1 id="修改数据update"><a href="#修改数据update" class="headerlink" title="修改数据update"></a>修改数据update</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update t_table set 字段名1=值1, 字段名2=值2, ... where 条件;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 将部门10的loc修改为shanghai，将部门名称改为renshibu</span><br><span class="line">update tmp_dept set loc = &#x27;shanghai&#x27;, dname = &#x27;renshibu&#x27; where deptno = 10;</span><br><span class="line"># 没有where条件时更新所有记录</span><br><span class="line">update tmp_dept set loc = &#x27;x&#x27;, dname = &#x27;y&#x27;;</span><br></pre></td></tr></table></figure>



<h1 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete from t_table where 条件;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 条件删除</span><br><span class="line">delete from tmp_dept where deptno = 10;</span><br><span class="line"># 删除全部表记录</span><br><span class="line">delete from tmp_dept;</span><br></pre></td></tr></table></figure>

<p>如果表数据庞大，使用delete删除要很久，因为它没有释放数据，可以回滚记录。</p>
<p>因此使用<code>truncate</code>语句删除大表，表被截断，不可回滚，永久丢失</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">truncate table tmp_dept; </span><br></pre></td></tr></table></figure>

<p>1.DELETE 可以加where 条件，truncate 不能加</p>
<p>2.truncate删除，效率高一些</p>
<p>3.假如要删除的表中有自增长列，如果用delete 删除后，再插入数据，自增长列的值从断点开始，而truncate删除后，再插入数据，自增长列的值从1开始</p>
<p>4.truncate删除后没有返回值，delete 删除有返回值</p>
<p>5.truncate 删除后不能回滚，delete 删除可以回滚</p>
<p>1.DROP TABLE　清除数据并且销毁表，是一种数据库定义语言(DDL Data Definition Language), 执行后不能撤销，被删除表格的关系，索引，权限等等都会被永久删除。</p>
<p>2.TRUNCATE TABLE　只清除数据，保留表结构，列，权限，索引，视图，关系等等，相当于清零数据，是一种数据库定义语言(DDL Data Definition Language)，执行后不能撤销。</p>
<p>3.DELETE TABLE　删除（符合某些条件的）数据，是一种数据操纵语言(DML Data Manipulation Language)，执行后可以撤销。</p>
<h1 id="删表"><a href="#删表" class="headerlink" title="删表"></a>删表</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">drop table t_student; # 通用写法</span><br><span class="line">drop table if exists t_student; # mysql写法</span><br></pre></td></tr></table></figure>

<h1 id=""><a href="#" class="headerlink" title=""></a></h1><h1 id="表结构"><a href="#表结构" class="headerlink" title="表结构"></a>表结构</h1><p>1.添加列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add column 列名 类型 【first|after 字段名】;</span><br></pre></td></tr></table></figure>

<p>2.修改列的类型或约束</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 modify column 列名 新类型 【新约束】;</span><br></pre></td></tr></table></figure>

<p>3.修改列名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 change column 旧列名 新列名 类型;</span><br></pre></td></tr></table></figure>

<p>4 .删除列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 drop column 列名;</span><br></pre></td></tr></table></figure>

<p>5.修改表名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 rename 【to】 新表名;</span><br></pre></td></tr></table></figure>

<p>6.将某一列放到第一列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 modify column 列名 类型 first;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>题目：<a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/d08209df6f464cebafda5dfd5de03fce?tpId=240&tqId=2223567&ru=/practice/a61ee5519d14444aa99e530309a8e043&qru=/ta/sql-advanced/question-ranking&sourceUrl=/exam/company">https://www.nowcoder.com/practice/d08209df6f464cebafda5dfd5de03fce?tpId=240&amp;tqId=2223567&amp;ru=%2Fpractice%2Fa61ee5519d14444aa99e530309a8e043&amp;qru=%2Fta%2Fsql-advanced%2Fquestion-ranking&amp;sourceUrl=%2Fexam%2Fcompany</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE user_info ADD COLUMN school VARCHAR(15) AFTER level;</span><br><span class="line">ALTER TABLE user_info CHANGE COLUMN job profession VARCHAR(10);</span><br><span class="line">ALTER TABLE user_info MODIFY COLUMN achievement INT(11) default 0;  # 新类型必须要</span><br></pre></td></tr></table></figure>



<h1 id="约束constraint"><a href="#约束constraint" class="headerlink" title="约束constraint"></a>约束constraint</h1><p>约束测试代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">drop table t_user;</span><br><span class="line">create table t_user(</span><br><span class="line">	id int primary key,</span><br><span class="line">    email varchar(255),</span><br><span class="line">    username varchar(255) </span><br><span class="line">);</span><br><span class="line">insert into t_user(id, username, email) values(1,&#x27;cj1&#x27;,&#x27;123@qq.com&#x27;);</span><br><span class="line">insert into t_user(id, username, email) values(2,&#x27;cj2&#x27;,&#x27;234@qq.com&#x27;);</span><br><span class="line">insert into t_user(id, username, email) values(3,&#x27;cj3&#x27;,&#x27;345@qq.com&#x27;);</span><br></pre></td></tr></table></figure>

<p>保证表内数据的合法性、有效性、完整性，例如某些</p>
<ul>
<li>非空约束（not null）：不能为空</li>
<li>唯一约束（unique）：不能重复</li>
<li>主键约束（primary key）：既不能为null，也不能重复</li>
<li>外键约束（foreign key, FK）：</li>
<li>检查约束（check）：mysql无，oracle有。</li>
</ul>
<h2 id="非空约束-not-nll"><a href="#非空约束-not-nll" class="headerlink" title="非空约束 not nll"></a>非空约束 not nll</h2><p>只能在字段后面添加</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table t_user(</span><br><span class="line">	id int,</span><br><span class="line">    username varchar(255) not null,  # 非空</span><br><span class="line">    password varchar(255) </span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="唯一性约束-unique"><a href="#唯一性约束-unique" class="headerlink" title="唯一性约束 unique"></a>唯一性约束 unique</h2><p>可以为null</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table t_user(</span><br><span class="line">	id int,</span><br><span class="line">    usercode varchar(255) unique# 不能重复 （列级约束）</span><br><span class="line">    username varchar(255) unique# 不能重复 （列级约束）</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>联合unique，not null 没有此写法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table t_user(</span><br><span class="line">	id int,</span><br><span class="line">    usercode varchar(255) </span><br><span class="line">    username varchar(255) </span><br><span class="line">	unique(usercode, username) # 联合unique，两个字段的值不能同时相同 （表级约束）</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="主键约束-primary-key"><a href="#主键约束-primary-key" class="headerlink" title="主键约束 primary key"></a>主键约束 primary key</h2><h3 id="相关术语："><a href="#相关术语：" class="headerlink" title="相关术语："></a>相关术语：</h3><p>主键约束（primary key本身）、主键字段（有primary key的字段）、主键值（主键字段的值）</p>
<ul>
<li>只要主键不一样，就认为是不一样的记录，是表里的唯一表示。</li>
<li>表的设计三范式中，第一范式就是任何一张表都应该有主键，任何一张表只能有一个主键。</li>
</ul>
<h3 id="主键分类："><a href="#主键分类：" class="headerlink" title="主键分类："></a>主键分类：</h3><ul>
<li>根据主键字段数量来划分<ul>
<li>单一主键</li>
<li>复合主键（不建议使用，违背三范式）：多个字段联合起来添加一个主键约束</li>
</ul>
</li>
<li>根据主键性质来划分<ul>
<li>自然主键</li>
<li>业务主键（不建议使用）：身份证、银行卡号</li>
</ul>
</li>
</ul>
<h3 id="主键自增"><a href="#主键自增" class="headerlink" title="主键自增"></a>主键自增</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">drop table t_user;</span><br><span class="line">create table t_user(</span><br><span class="line">	id int primary key auto_increment, # 自动维护一个以1开始自增的</span><br><span class="line">    username varchar(255)</span><br><span class="line">);</span><br><span class="line">insert into t_user(username) values(&#x27;a&#x27;);</span><br><span class="line">insert into t_user(username) values(&#x27;b&#x27;);</span><br><span class="line">select * from t_user;</span><br><span class="line">+----+----------+</span><br><span class="line">| id | username |</span><br><span class="line">+----+----------+</span><br><span class="line">|  1 | a        |</span><br><span class="line">|  2 | b        |</span><br><span class="line">+----+----------+</span><br></pre></td></tr></table></figure>

<p>oracle提供了一种自增机制：sequence序列</p>
<h2 id="外键约束"><a href="#外键约束" class="headerlink" title="外键约束"></a>外键约束</h2><h3 id="相关术语"><a href="#相关术语" class="headerlink" title="相关术语"></a>相关术语</h3><p>主键约束（primary key本身）、主键字段（有primary key的字段）、主键值（主键字段的值）</p>
<h3 id="业务背景："><a href="#业务背景：" class="headerlink" title="业务背景："></a>业务背景：</h3><p>设计数据库表，维护学生和班级的信息，区分出班级表和学生表</p>
<pre><code>                t_class 班级表
--------------------------------------------------------
cno(pk)		cname
--------------------------------------------------------
101			北京大兴区经济技术开发区亦庄二中高三1班
102			北京大兴区经济技术开发区亦庄二中高三2班
--------------------------------------------------------

                t_student 学生表
--------------------------------------------------------
sno(pk)		sname		classno(该字段添加外键约束fk)
--------------------------------------------------------
1			zs1			101
2			zs2			101
3			zs3			102
4			zs4			102
5			zs5			102
--------------------------------------------------------
</code></pre>
<p>加上了外键约束后，classno的值只能来自于t_class的cno。</p>
<ul>
<li>t_student中的clasno字段引用 t_class表中的cno字段。此时t_student是子表，t_class为父表。<ul>
<li>删除数据的时候，先删除子表，再删除父表。</li>
<li>添加数据的时候，先添加父表，在添加子表。</li>
<li>创建表的时候，先创建父表，再创建子表。</li>
<li>删除表的时候，先删除子表，在删除父表。</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">drop table if exists t_student;</span><br><span class="line">drop table if exists t_class;</span><br><span class="line">#</span><br><span class="line">create table t_class(</span><br><span class="line">	cno int primary key,</span><br><span class="line">    cname varchar(255),</span><br><span class="line">);</span><br><span class="line">#</span><br><span class="line">create table t_student(</span><br><span class="line">	sno int primary key,</span><br><span class="line">    sname varchar(255),</span><br><span class="line">    classno int,</span><br><span class="line">    foreign key(classno) references t_class(cno)</span><br><span class="line">);</span><br><span class="line">insert into t_class values(101,&#x27;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#x27;);</span><br><span class="line">insert into t_class values(102,&#x27;yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy&#x27;);</span><br><span class="line"></span><br><span class="line">insert into t_student values(1,&#x27;zs1&#x27;,101);</span><br><span class="line">insert into t_student values(2,&#x27;zs2&#x27;,101);</span><br><span class="line">insert into t_student values(3,&#x27;zs3&#x27;,102);</span><br><span class="line">insert into t_student values(4,&#x27;zs4&#x27;,102);</span><br><span class="line">insert into t_student values(5,&#x27;zs5&#x27;,102);</span><br><span class="line">insert into t_student values(6,&#x27;zs6&#x27;,102);</span><br><span class="line">select * from t_class;</span><br><span class="line">select * from t_student;</span><br><span class="line"></span><br><span class="line">insert into t_student values(7,&#x27;zs6&#x27;,103); # 103在t_class.cno不存在</span><br><span class="line">ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails (`dljd`.`t_student`, CONSTRAINT `t_student_ibfk_1` FOREIGN KEY (`classno`) REFERENCES `t_class` (`cno`))</span><br><span class="line">insert into t_student values(8,&#x27;zs6&#x27;); # 插入成功，外键可以为null</span><br></pre></td></tr></table></figure>

<ul>
<li>外键可以为null</li>
<li>被引用的字段不一定是主键，但至少具有unique约束，也就是能找到一个唯一的记录，如t_class里cno可以不是主键，但不能有两个101的记录。</li>
</ul>
<h1 id="存储引擎（了解即可）"><a href="#存储引擎（了解即可）" class="headerlink" title="存储引擎（了解即可）"></a>存储引擎（了解即可）</h1><p>存储引擎只在mysql存在。oracle也有对应机制，只称为：存储方式。</p>
<p>每种存储引擎都只有自己有缺点，对应一种存储方式。</p>
<p>完整的建表语句，还要指定存储引擎、字符集</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `t_x` (</span><br><span class="line">    `id` int(11) DEFAULT NULL</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8;</span><br><span class="line"># 飘号 ``， mysql可用但不通用，最好不用</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 查看mysql支持的存储引擎</span><br><span class="line">show engines \G </span><br></pre></td></tr></table></figure>

<p>常见的存储引擎：</p>
<pre><code>Engine: MyISAM
Support: YES
Comment: MyISAM storage engine
Transactions: NO
XA: NO
Savepoints: NO

MyISAM这种存储引擎不支持事务。
MyISAM是mysql最常用的存储引擎，但是这种引擎不是默认的。
MyISAM采用三个文件组织一张表：
    xxx.frm（存储格式的文件）
    xxx.MYD（存储表中数据的文件）
    xxx.MYI（存储表中索引的文件）
优点：可被压缩，节省存储空间。并且可以转换为只读表，提高检索效率。
缺点：不支持事务。

-----------------------------------------------------------------------------

Engine: InnoDB
Support: DEFAULT
Comment: Supports transactions, row-level locking, and foreign keys
Transactions: YES
XA: YES
Savepoints: YES

优点：支持事务、行级锁、外键等。这种存储引擎数据的安全得到保障。

表的结构存储在xxx.frm文件中
数据存储在tablespace这样的表空间中（逻辑概念），无法被压缩，无法转换成只读。
这种InnoDB存储引擎在MySQL数据库崩溃之后提供自动恢复机制。
InnoDB支持级联删除和级联更新。
    
-------------------------------------------------------------------------------------

Engine: MEMORY
Support: YES
Comment: Hash based, stored in memory, useful for temporary tables
Transactions: NO
XA: NO
Savepoints: NO

缺点：不支持事务。数据容易丢失。因为所有数据和索引都是存储在内存当中的。
优点：查询速度最快。
以前叫做HEPA引擎。
</code></pre>
<h1 id="事务（Transaction）"><a href="#事务（Transaction）" class="headerlink" title="事务（Transaction）"></a>事务（Transaction）</h1><p>一个事务是完整的业务逻辑单元，不可再分，例如银行账户A向账户B转账，需要执行两条upda语句，不允许一条成功，一条失败。</p>
<ul>
<li><p>如何保证这两条DML语句全部成功：事务机制。和事务相关的语句只有DML语句（insert delete update），因为这三个语句都与数据相关。</p>
</li>
<li><p>当只有一条DML语句时，不需要事务机制。</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">insert -&gt; update -&gt;delete</span><br><span class="line">开启事务机制（开始）</span><br><span class="line">执行insert语句-&gt; insert执行成功后，记录到数据库的历史操作，不修改硬盘数据。</span><br><span class="line">执行update语句-&gt; update执行成功后，记录到数据库的历史操作，不修改硬盘数据。</span><br><span class="line">执行delete语句-&gt; delete执行成功后，记录到数据库的历史操作，不修改硬盘数据。</span><br><span class="line">提交事务或回滚事务（结束）# SQL语句分类中的 TCL（事务控制语言）：commit提交事务，rollback回滚事务</span><br></pre></td></tr></table></figure>

<h2 id="事务四大特性ACID"><a href="#事务四大特性ACID" class="headerlink" title="事务四大特性ACID"></a>事务四大特性ACID</h2><ul>
<li>A：原子性，事务是最小的工作单元，不可再分</li>
<li>C：一致性，事务必须保证多条DML语句同时成功或同时失败</li>
<li>I：隔离性，事务A与B之间具有隔离<ul>
<li>第一级别：读未提交（read uncommitted)：对方事务还没提交，当前事务可用读取到未提交的数据，<ul>
<li>问题：存在脏读（dirty read）现象，表示读到了未在硬盘的数据。</li>
</ul>
</li>
<li>第二级别：读提交（read committed)：对方事务提交后的数据，我方可用读到。解决脏读问题。<ul>
<li>问题：不可重复读取，如果有其他事务一直在修改，每次数据读出来不一样。</li>
</ul>
</li>
<li>第三级别：可重复读（repeatable read）：读到的永远是开启事务前的数据，即便其他用户已经修改或删除了数据，读取的仍是备份数据。解决了不可重复读问题<ul>
<li>问题：读取到的是过期数据。</li>
</ul>
</li>
<li>第四级别：序列化读&#x2F;串行化读：两个事务不能并发。解决以上问题。<ul>
<li>问题：效率低，事务排队。</li>
</ul>
</li>
</ul>
</li>
<li>D：持久性，最终处理的数据必须持久化到硬盘文件中，事务才算成功结束</li>
</ul>
<p>oracle默认的隔离级别是第二级别起步，mysql则是第三级别。</p>
<h2 id="演示事务"><a href="#演示事务" class="headerlink" title="演示事务"></a>演示事务</h2><p>准备表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">drop table if exists t_user;</span><br><span class="line">create table t_user(</span><br><span class="line">	id int primary key auto_increment,</span><br><span class="line">    username varchar(255)</span><br><span class="line">);</span><br><span class="line">insert into t_user(username) values(&#x27;cj1&#x27;);</span><br></pre></td></tr></table></figure>

<p>mysql事务自动提交，即只要执行一次DML提交一次。</p>
<p>使用<code>start transaction</code>关闭自动提交机制，开启事务机制。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"># 事务开始</span><br><span class="line">mysql&gt; start transaction;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"># 连续的两条插入</span><br><span class="line">mysql&gt; insert into t_user(username) values(&#x27;cj2&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line">mysql&gt; insert into t_user(username) values(&#x27;cj3&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line">mysql&gt; select * from t_user;</span><br><span class="line">+----+----------+</span><br><span class="line">| id | username |</span><br><span class="line">+----+----------+</span><br><span class="line">|  1 | cj1      |</span><br><span class="line">|  2 | cj2      |</span><br><span class="line">|  3 | cj3      |</span><br><span class="line">+----+----------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"># rollback回滚到事务开始前</span><br><span class="line">mysql&gt; rollback;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line">mysql&gt; select * from t_user;</span><br><span class="line">+----+----------+</span><br><span class="line">| id | username |</span><br><span class="line">+----+----------+</span><br><span class="line">|  1 | cj1      |</span><br><span class="line">+----+----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"># 再插入，发现主键不从2开始了</span><br><span class="line">mysql&gt; insert into t_user(username) values(&#x27;cj4&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line">mysql&gt; select * from t_user;</span><br><span class="line">+----+----------+</span><br><span class="line">| id | username |</span><br><span class="line">+----+----------+</span><br><span class="line">|  1 | cj1      |</span><br><span class="line">|  4 | cj4      |</span><br><span class="line">+----+----------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>



<p>设置全局隔离权限</p>
<p>测试权限时，可以开启cmd连接数据库，一个修改数据，另一个查看数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 演示第1级别：读未提交</span><br><span class="line">set global transaction isolation level read uncommitted;</span><br><span class="line"># 演示第2级别：读已提交</span><br><span class="line">set global transaction isolation level read committed;</span><br><span class="line"># 演示第3级别：可重复读</span><br><span class="line">set global transaction isolation level repeatable read;</span><br><span class="line"># 序列化读</span><br><span class="line">set global transaction isolation level  serializable;</span><br></pre></td></tr></table></figure>

<p>查看全局隔离权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># mysql&gt; select @@global.tx_isolation; # 旧版的方法</span><br><span class="line">mysql&gt; select @@global.transaction_isolation;</span><br><span class="line">+--------------------------------+</span><br><span class="line">| @@global.transaction_isolation |</span><br><span class="line">+--------------------------------+</span><br><span class="line">| READ-COMMITTED                 |</span><br><span class="line">+--------------------------------+</span><br></pre></td></tr></table></figure>



<h1 id="索引（底层是红黑树）"><a href="#索引（底层是红黑树）" class="headerlink" title="索引（底层是红黑树）"></a>索引（底层是红黑树）</h1><p>查询一张表的时候有两种检索方式：</p>
<ul>
<li>全表扫描</li>
<li>根据索引检索（效率很高）</li>
</ul>
<p>索引虽然可以提高检索效率，但是不能随意的添加索引，因为索引也是数据库当中的对象，需要数据库不断的维护。是有维护成本的</p>
<p>什么情况索引更好?</p>
<ul>
<li>数据量庞大</li>
<li>该字段很少DML操作，为数据一旦修改，索引需要重新排序，进行维护。</li>
<li>该字段经常出现在where子句中。</li>
</ul>
<p>注意：</p>
<ul>
<li>主键和具有unique的字段自动有索引，因此根据主键索引效率更高。</li>
<li>当模糊查询时，第一个通配符是%时，索引会失效。</li>
</ul>
<h1 id="创建索引和删除索引"><a href="#创建索引和删除索引" class="headerlink" title="创建索引和删除索引"></a>创建索引和删除索引</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 创建索引对象</span><br><span class="line">create index index_name on table1(field1);</span><br><span class="line"># 删除索引对象</span><br><span class="line">drop index index_name on table1; # mysql</span><br><span class="line">drop index index_name; #oracle</span><br></pre></td></tr></table></figure>

<h3 id="创建索引例题"><a href="#创建索引例题" class="headerlink" title="创建索引例题"></a>创建索引例题</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/f2ea9ccf33c740d58576608940981807?tpId=240&tqId=2223570&ru=/practice/f2ea9ccf33c740d58576608940981807&qru=/ta/sql-advanced/question-ranking&sourceUrl=/exam/company">https://www.nowcoder.com/practice/f2ea9ccf33c740d58576608940981807?tpId=240&amp;tqId=2223570&amp;ru=%2Fpractice%2Ff2ea9ccf33c740d58576608940981807&amp;qru=%2Fta%2Fsql-advanced%2Fquestion-ranking&amp;sourceUrl=%2Fexam%2Fcompany</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE INDEX idx_duration ON examination_info(duration); # 普通索引</span><br><span class="line">CREATE FULLTEXT INDEX full_idx_tag ON examination_info(tag);  # 全文索引</span><br><span class="line">CREATE UNIQUE INDEX uniq_idx_exam_id ON examination_info(exam_id); # 唯一性索引</span><br></pre></td></tr></table></figure>

<h3 id="删除索引例题"><a href="#删除索引例题" class="headerlink" title="删除索引例题"></a>删除索引例题</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/4963f6d63dde48d787aaa2b43460fb4b?tpId=240&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=/exam/company">https://www.nowcoder.com/practice/4963f6d63dde48d787aaa2b43460fb4b?tpId=240&amp;tags=&amp;title=&amp;difficulty=0&amp;judgeStatus=0&amp;rp=0&amp;sourceUrl=%2Fexam%2Fcompany</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DROP INDEX uniq_idx_exam_id ON examination_info;</span><br><span class="line">DROP INDEX full_idx_tag ON examination_info;</span><br></pre></td></tr></table></figure>





<p>对比是否使用索引的查询方式和查询数据量：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 解释语句的执行过程</span><br><span class="line">mysql&gt; explain select * from emp where sal = 5000;</span><br><span class="line"># type字段为all，表示全表扫描；rows=14，表示扫描了14行才扫到。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 为sal字段创建索引</span><br><span class="line">mysql&gt; create index emp_sal_index on emp(sal);</span><br><span class="line">Query OK, 0 rows affected (0.08 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br><span class="line">mysql&gt; explain select * from emp where sal = 5000;</span><br><span class="line"># type字段为ref，表示索引扫描；rows=1，表示扫描了1行就扫到了。</span><br></pre></td></tr></table></figure>

<h2 id="创建索引"><a href="#创建索引" class="headerlink" title="创建索引"></a>创建索引</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/f2ea9ccf33c740d58576608940981807?tpId=240&tqId=2223570&ru=/practice/f2ea9ccf33c740d58576608940981807&qru=/ta/sql-advanced/question-ranking&sourceUrl=/exam/company">https://www.nowcoder.com/practice/f2ea9ccf33c740d58576608940981807?tpId=240&amp;tqId=2223570&amp;ru=%2Fpractice%2Ff2ea9ccf33c740d58576608940981807&amp;qru=%2Fta%2Fsql-advanced%2Fquestion-ranking&amp;sourceUrl=%2Fexam%2Fcompany</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE INDEX idx_duration ON examination_info(duration); # 普通索引</span><br><span class="line">CREATE FULLTEXT INDEX full_idx_tag ON examination_info(tag);  # 全文索引</span><br><span class="line">CREATE UNIQUE INDEX uniq_idx_exam_id ON examination_info(exam_id); # 唯一性索引</span><br></pre></td></tr></table></figure>



<h2 id="索引原理"><a href="#索引原理" class="headerlink" title="索引原理"></a>索引原理</h2><p><img src="https://raw.githubusercontent.com/drinkwateronly/Image-Host/main/iimage/image-20230830192308964.png" alt="image-20230830192308964"></p>
<p>通过B Tree缩小扫描范围，底层索引进行了排序，分区，索引会携带数据在表中的“物理地址”，最终通过索引检索到数据之后，获取到关联的物理地址，通过物理地址定位表中的数据。<br>            select ename from emp where ename &#x3D; ‘SMITH’;<br>            通过索引转换为：<br>            select ename from emp where 物理地址 &#x3D; 0x3;</p>
<h2 id="索引分类（了解）"><a href="#索引分类（了解）" class="headerlink" title="索引分类（了解）"></a>索引分类（了解）</h2><ul>
<li>单一索引：单个字段</li>
<li>复合索引：多个字段</li>
<li>主键索引：</li>
<li>唯一索引：</li>
</ul>
<h1 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h1><p>只是表的保密表现形式。</p>
<p>作用：视图可以隐藏表的实现细节。保密级别较高的系统，数据库只对外提供相关的视图，程序员只对视图对象进行CRUD。</p>
<p>视图对象只能用上述的DQL语句创建出来：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 创建视图</span><br><span class="line">create view myview as select 字段1,字段2 from 表;</span><br><span class="line"># 删除视图</span><br><span class="line">drop view myview;</span><br></pre></td></tr></table></figure>

<p>对视图进行增删改查CRUD会影响原表数据，但不是直接操作原表：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create table emp_bak as select * from emp;</span><br><span class="line">create view myview1 as select empno,ename,sal from emp_bak;</span><br><span class="line">update myview1 set ename=&#x27;hehe&#x27;,sal=1 where empno = 7369; # 通过视图修改原表数据。</span><br><span class="line">delete from myview1 where empno = 7369; # 通过视图删除原表数据。</span><br></pre></td></tr></table></figure>



<h1 id="DBA命令"><a href="#DBA命令" class="headerlink" title="DBA命令"></a>DBA命令</h1><h2 id="导出"><a href="#导出" class="headerlink" title="导出"></a>导出</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; mysqldump 数据库名 表名（表名可省略） &gt; 路径\文件名.sql -uroot -p</span><br><span class="line">mysqldump dljd &gt; C:\Users\imcj0\Documents\export.sql -uroot -p</span><br></pre></td></tr></table></figure>

<h2 id="导入"><a href="#导入" class="headerlink" title="导入"></a>导入</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create database dljd_tmp;  # 创建数据库</span><br><span class="line">use dljd_tmp; #</span><br><span class="line">source C:\Users\imcj0\Documents\export.sql;</span><br></pre></td></tr></table></figure>



<h1 id="数据库设计三范式（重点）"><a href="#数据库设计三范式（重点）" class="headerlink" title="数据库设计三范式（重点）"></a>数据库设计三范式（重点）</h1><p>按照三范式设计的表不会出现数据冗余，在实际的开发中，以满足客户的需求为主，有的时候会拿冗余换执行速度。</p>
<ul>
<li>第一范式：任何一张表都应该有主键，并且每一个字段原子性不可再分。</li>
<li>第二范式：建立在第一范式的基础之上，所有非主键字段完全依赖主键，不能产生部分依赖。<ul>
<li>多对多关系，使用三张表，关系表两个外键：</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">t_student学生表</span><br><span class="line">sno(pk)		sname</span><br><span class="line">-------------------</span><br><span class="line">1			张三</span><br><span class="line">2			李四</span><br><span class="line">3			王五</span><br><span class="line"></span><br><span class="line">t_teacher 讲师表</span><br><span class="line">tno(pk)		tname</span><br><span class="line">---------------------</span><br><span class="line">1			王老师</span><br><span class="line">2			张老师</span><br><span class="line">3			李老师</span><br><span class="line"></span><br><span class="line">t_student_teacher_relation 学生讲师关系表</span><br><span class="line">id(pk)		sno(fk)		tno(fk)</span><br><span class="line">----------------------------------</span><br><span class="line">1			1			3</span><br><span class="line">2			1			1</span><br><span class="line">3			2			2</span><br><span class="line">4			2			3</span><br><span class="line">5			3			1</span><br><span class="line">6			3			3</span><br></pre></td></tr></table></figure>

<ul>
<li><p>建立在第二范式的基础之上，所有非主键字段直接依赖主键，不能产生传递依赖。</p>
<ul>
<li><p>一对多关系，使用两张表，多的表加外键。</p>
<p>如果不遵循第三范式，那么t_class的cname会在t_student中的cname字段，而此时该字段不依赖主键sno。</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">班级t_class</span><br><span class="line">cno(pk)			cname</span><br><span class="line">--------------------------</span><br><span class="line">1				班级1</span><br><span class="line">2				班级2</span><br><span class="line"></span><br><span class="line">学生t_student</span><br><span class="line">sno(pk)			sname				classno(fk)</span><br><span class="line">---------------------------------------------</span><br><span class="line">101				张1				1</span><br><span class="line">102				张2				1</span><br><span class="line">103				张3				2</span><br><span class="line">104				张4				2</span><br><span class="line">105				张5				2</span><br><span class="line">		</span><br></pre></td></tr></table></figure>

<p>一对一设计：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">t_user_login  用户登录表</span><br><span class="line">id(pk)		username		password</span><br><span class="line">--------------------------------------</span><br><span class="line">1			zs				123</span><br><span class="line">2			ls				456</span><br><span class="line"></span><br><span class="line">t_user_detail 用户详细信息表</span><br><span class="line">id(pk+fk)	realname		tel			....</span><br><span class="line">------------------------------------------------</span><br><span class="line">1			张三			1111111111</span><br><span class="line">2			李四			1111415621</span><br><span class="line"></span><br><span class="line">一对一设计有两种方案：外键唯一。</span><br><span class="line">t_user_login  用户登录表</span><br><span class="line">id(pk)		username		password</span><br><span class="line">--------------------------------------</span><br><span class="line">1			zs				123</span><br><span class="line">2			ls				456</span><br><span class="line"></span><br><span class="line">t_user_detail 用户详细信息表</span><br><span class="line">id(pk)	   realname			tel				userid(fk+unique)....</span><br><span class="line">-----------------------------------------------------------</span><br><span class="line">1			张三			1111111111			2</span><br><span class="line">2			李四			1111415621			1</span><br><span class="line">			</span><br></pre></td></tr></table></figure>



<h1 id="日期"><a href="#日期" class="headerlink" title="日期"></a>日期</h1><p>确定两个概念：<strong>日期和时间</strong>。</p>
<p>格式</p>
<ul>
<li>DATE：仅包含日期部分，格式为’YYYY-MM-DD’，例如’2023-07-06’。</li>
<li>TIME：仅包含时间部分，格式为’HH:MM:SS’，例如’13:30:45’。</li>
<li>DATETIME：包含日期和时间部分，格式为’YYYY-MM-DD HH:MM:SS’，例如’2023-07-06 13:30:45’。</li>
<li>TIMESTAMP：与DATETIME相似，格式为’YYYY-MM-DD HH:MM:SS’，但在存储和使用上有一些差异。</li>
</ul>
<h3 id="日期函数："><a href="#日期函数：" class="headerlink" title="日期函数："></a>日期函数：</h3><ul>
<li><p><code>CURDATE()</code> <code>CURRENT_DATE()</code>，返回当前日期</p>
</li>
<li><p><code>CURTIME()</code> <code>CURRENT_TIME()</code>，返回当前时间</p>
</li>
<li><p><code>NOW() </code> <code>CURRENT_TIMESTAMP()</code>，返回当前日期和时间</p>
</li>
<li><p><code>DATA_FORMAT()</code>，格式化符号来表示年、月、日、小时、分钟、秒。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT DATE_FORMAT(NOW(), &#x27;%Y-%m-%d %H:%i:%s&#x27;); </span><br><span class="line"># 2023-09-01 23:25:07</span><br><span class="line">SELECT DATE_FORMAT(NOW(), &#x27;%W, %M %e, %Y&#x27;);</span><br><span class="line"># Friday, September 1, 2023 </span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="日期运算符"><a href="#日期运算符" class="headerlink" title="日期运算符"></a>日期运算符</h3><ul>
<li><p><code>DATE_ADD()</code> <code>DATE_SUB()</code>，当前日期减去一定时间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT DATE_ADD(NOW(), INTERVAL 2 DAY); </span><br><span class="line">SELECT DATE_SUB(NOW(), INTERVAL 1 MINUTE); </span><br></pre></td></tr></table></figure>
</li>
<li><p><code>DATEDIFF()</code>，计算两个日期<strong>天数（d）</strong>之差</p>
</li>
<li><p><code>TIMEDIFF()</code>，计算两个日期<strong>时间（h,m,s）</strong>之差</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT DATEDIFF(DATE_SUB(NOW(), INTERVAL 10 DAY), NOW());  # -10</span><br></pre></td></tr></table></figure>


</li>
<li><p><code>timestampdiff(unit,begin,end)</code></p>
<ul>
<li><p>TIMESTAMPDIFF函数返回begin-end的结果，其中begin和end是DATE或DATETIME表达式。</p>
<p>TIMESTAMPDIFF函数允许其参数具有混合类型，例如，begin是DATE值，end可以是DATETIME值。 如果使用DATE值，则TIMESTAMPDIFF函数将其视为时间部分为“00:00:00”的DATETIME值</p>
</li>
<li><p>unit则为返回的单位</p>
<ul>
<li>MICROSECOND</li>
<li>SECOND</li>
<li>MINUTE</li>
<li>HOUR</li>
<li>DAY</li>
<li>WEEK</li>
<li>MONTH</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="从时间中获取其中的一部分，比如只获取小时、月份等。"><a href="#从时间中获取其中的一部分，比如只获取小时、月份等。" class="headerlink" title="从时间中获取其中的一部分，比如只获取小时、月份等。"></a>从时间中获取其中的一部分，比如只获取小时、月份等。</h3><ul>
<li><p><code>YEAR() MONTH() DAY() HOUR() MINUTE() SECOND()</code>，获取日期+时间中的对应部分。</p>
</li>
<li><p><code>DATE()</code>，获取日期+时间的<strong>日期</strong>部分，格式化的数据也能获取</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT DATE(NOW()); # 成功</span><br><span class="line">SELECT DATE(DATE_FORMAT(NOW(), &#x27;%Y-%m-%d %H:%i:%s&#x27;)); # 成功</span><br><span class="line">SELECT DATE(DATE_FORMAT(NOW(), &#x27;%Y-%m&#x27;)); # null</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>TIME()</code>，获取日期+时间的<strong>时间</strong>部分</p>
</li>
<li><p><code>DATENAME()</code> <code>MONTHNAME()</code> 获取星期&#x2F;月份的全称。</p>
</li>
<li><p><code>LAST_DAY()</code>返回日期参数的某月最后一天</p>
</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/11/17/MySQL/error_report/" rel="prev" title="MySQL报错与解决方案">
                  <i class="fa fa-angle-left"></i> MySQL报错与解决方案
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/11/17/network_programming/0%E3%80%81%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA/" rel="next" title="">
                   <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Wallnut</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  <script src="/js/third-party/pace.js"></script>


  





</body>
</html>
